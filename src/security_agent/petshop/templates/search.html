{% extends "base.html" %}
{% block title %}Search â€” Pet Shop{% endblock %}
{% block content %}
<h2 style="margin-bottom: 1rem;">ğŸ” Search Results</h2>

<form class="search-bar" action="/search" method="get">
    <input type="text" name="q" value="{{ query }}" placeholder="Search for pets...">
    <button type="submit">Search</button>
</form>

{% if query %}
{# âš ï¸ VULNERABLE: query rendered without escaping via |safe â€” reflected XSS #}
<p style="margin-bottom: 1rem; color: #666;">
    Showing results for: <strong>{{ query|safe }}</strong>
</p>
{% endif %}

{% if results %}
<div class="product-grid">
    {% for product in results %}
    <div class="product-card">
        <a href="/product/{{ product.id }}">
            <div class="image">
                {% if product.species == 'Dog' %}ğŸ•
                {% elif product.species == 'Cat' %}ğŸˆ
                {% elif product.species == 'Rabbit' %}ğŸ‡
                {% elif product.species == 'Bird' %}ğŸ¦
                {% else %}ğŸ¾{% endif %}
            </div>
            <div class="info">
                <div class="name">{{ product.name }}</div>
                <div class="species">{{ product.species }} â€” {{ product.breed }}</div>
                <div class="price">${{ "%.2f"|format(product.price) }}</div>
            </div>
        </a>
    </div>
    {% endfor %}
</div>
{% elif query %}
<p style="color: #999;">No results found for "{{ query }}"</p>
{% endif %}
{% endblock %}